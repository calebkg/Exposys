<mat-toolbar class="navbar" color="primary">
  <button
    type="button"
    aria-label="Toggle sidenav"
    mat-icon-button
    (click)="drawer.toggle()"
    *ngIf="drawer"
  >
    <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
  </button>

  <span class="navbar-title">Expense Manager</span>

  <div class="spacer"></div>

  <div class="navbar-actions">
    <!-- Theme Toggle -->
    <button
      mat-icon-button
      (click)="toggleTheme()"
      [attr.aria-label]="'Toggle theme'"
      class="theme-toggle"
    >
      <mat-icon>{{
        (isDarkMode$ | async) ? "light_mode" : "dark_mode"
      }}</mat-icon>
    </button>

    <!-- User Menu -->
    <button
      mat-icon-button
      [matMenuTriggerFor]="userMenu"
      class="user-menu-trigger"
    >
      <div class="user-avatar">
        <img
          *ngIf="(currentUser$ | async)?.profilePicture"
          [src]="(currentUser$ | async)?.profilePicture"
          [alt]="(currentUser$ | async)?.firstName"
          class="avatar-image"
        />
        <mat-icon *ngIf="!(currentUser$ | async)?.profilePicture"
          >account_circle</mat-icon
        >
      </div>
    </button>

    <mat-menu #userMenu="matMenu" class="user-menu">
      <div class="user-info" mat-menu-item disabled>
        <div class="user-details">
          <div class="user-name">
            {{ (currentUser$ | async)?.firstName }}
            {{ (currentUser$ | async)?.lastName }}
          </div>
          <div class="user-email">{{ (currentUser$ | async)?.email }}</div>
        </div>
      </div>
      <mat-divider></mat-divider>
      <button mat-menu-item routerLink="/profile">
        <mat-icon>person</mat-icon>
        <span>Profile</span>
      </button>
      <button mat-menu-item routerLink="/activity-logs">
        <mat-icon>history</mat-icon>
        <span>Activity Logs</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="logout()" class="logout-button">
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>
